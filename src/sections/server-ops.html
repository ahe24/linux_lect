<section id="server-ops" class="content-section">

    <h1>Server & User Management</h1>
    <p>여러 엔지니어가 사용하는 시뮬레이션 서버를 관리하기 위한 필수 명령어입니다.</p>

    <h2>1. 사용자 추가 및 그룹 관리</h2>
    <h3>사용자 및 그룹 생성</h3>
    <pre><code class="language-bash"># EDA 그룹 생성
sudo groupadd eda_users

# 사용자 생성 (홈 디렉토리 포함, bash 쉘 사용, 그룹 지정)
sudo useradd -m -g eda_users -s /bin/bash engineer01

# 비밀번호 설정
sudo passwd engineer01</code></pre>

    <h3>기존 사용자를 그룹에 추가</h3>
    <pre><code class="language-bash"># sudo 권한 부여 (Red Hat: wheel, Debian: sudo)
sudo usermod -aG wheel engineer01    # Red Hat/Rocky
sudo usermod -aG sudo engineer01     # Debian/Ubuntu

# 여러 그룹에 동시 추가 (-aG: append to group, 기존 그룹 유지)
sudo usermod -aG eda_users,docker,license_server engineer01

# ⚠️ 주의: -G만 사용하면 기존 그룹에서 제거되고 새 그룹만 남음 (위험!)
# sudo usermod -G newgroup engineer01  # 이렇게 하지 마세요!</code></pre>

    <h3>사용자 정보 확인</h3>
    <pre><code class="language-bash"># 현재 사용자 정보 (UID, GID, 소속 그룹)
id

# 특정 사용자 정보 확인
id engineer01
# uid=1001(engineer01) gid=1001(eda_users) groups=1001(eda_users),10(wheel)

# 사용자가 속한 모든 그룹 확인
groups engineer01

# 시스템의 모든 사용자 확인
getent passwd | tail -n 5

# 특정 그룹의 멤버 확인
getent group eda_users
# eda_users:x:1001:engineer01,engineer02,engineer03</code></pre>

    <div class="note-box">
        <i data-lucide="alert-circle"></i>
        <div>
            <strong>그룹 변경 후 재로그인 필수!</strong><br>
            <code>usermod -aG</code>로 그룹을 추가한 뒤에는 해당 사용자가 <strong>로그아웃 후 재로그인</strong>해야 새 그룹 권한이 적용됩니다.
            <code>groups</code> 명령으로 확인하세요.
        </div>
    </div>

    <h2>2. 실습: 프로젝트 공유 폴더 만들기 (SetGID)</h2>
    <p>팀원들이 파일을 생성할 때마다 자동으로 그룹 권한이 설정되도록 <strong>SetGID</strong>를 설정하는 과정을 실습해 봅니다.</p>

    <div class="code-step">
        <div class="step-title">Step 1: 디렉토리 생성 및 그룹 지정</div>
        <pre><code class="language-bash"># 1. 프로젝트 폴더 생성
sudo mkdir -p /projects/chip_a

# 2. 그룹 소유권 변경 (eda_users 그룹에게 권한 부여)
sudo chown -R :eda_users /projects/chip_a

# [확인] 아직 일반적인 권한 상태입니다.
ls -ld /projects/chip_a
# drwxr-xr-x 2 root eda_users 4096 Jan 26 10:00 /projects/chip_a</code></pre>
    </div>

    <div class="code-step">
        <div class="step-title">Step 2: 핵심! SetGID 설정 (g+s)</div>
        <pre><code class="language-bash"># 3. 그룹에 쓰기 권한(w)과 SetGID(s) 부여
sudo chmod g+w,g+s /projects/chip_a

# [확인] 그룹 권한 자리에 's'가 생긴 것을 주목하세요!
ls -ld /projects/chip_a
# drwxrwsr-x 2 root eda_users 4096 Jan 26 10:01 /projects/chip_a
#      ^ 여기가 's'로 변함 (이 폴더 내 생성 파일은 자동으로 eda_users 그룹 가짐)</code></pre>
    </div>

    <div class="code-step">
        <div class="step-title">Step 3: 동작 검증</div>
        <pre><code class="language-bash"># 4. 테스트 파일 생성 (현재 사용자: engineer01)
touch /projects/chip_a/test_logic.v

# [결과 확인] 파일의 그룹이 자동으로 'eda_users'로 설정됨
ls -l /projects/chip_a/test_logic.v
# -rw-rw-r-- 1 engineer01 eda_users 0 Jan 26 10:02 test_logic.v
#                          ^^^^^^^^^ (자동 상속 성공!)</code></pre>
    </div>
    <h2 class="break-before">3. 파일 관리 및 압축 (Archiving)</h2>
    <p>프로젝트 백업 및 대용량 시뮬레이션 데이터 이동 시 필수적인 명령어입니다.</p>

    <h3>파일 복사 및 이동</h3>
    <pre><code class="language-bash"># 디렉토리 통째로 복사 (-r: recursive, -p: 권한 보존, -v: 상세 출력)
cp -rpv project_v1 project_v1_backup

# 파일 이동 및 이름 변경
mv old_name.v new_name.v
mv *.v ../backup/</code></pre>

    <h3>압축 및 해제 (tar)</h3>
    <p>Linux에서는 주로 <code>tar.gz</code> 형식을 사용합니다. 옵션 순서(czvf)를 외워두면 편합니다.</p>
    <div class="note-box">
        <i data-lucide="package"></i>
        <div>
            <strong>핵심 옵션:</strong>
            <ul style="list-style: disc; margin-left: 20px; margin-top: 5px;">
                <li><strong>c</strong>: Create (압축 생성)</li>
                <li><strong>x</strong>: Extract (압축 해제)</li>
                <li><strong>z</strong>: gzip 압축 사용</li>
                <li><strong>v</strong>: Verbose (과정 출력)</li>
                <li><strong>f</strong>: File (파일명 지정, 항상 마지막에 위치)</li>
            </ul>
        </div>
    </div>

    <pre><code class="language-bash"># 프로젝트 압축하기 (현재 디렉토리의 projectA 폴더를 archive.tar.gz로)
tar -czvf archive.tar.gz ./projectA

# 압축 해제하기
tar -xzvf archive.tar.gz

# 특정 디렉토리에 풀기 (-C 옵션)
tar -xzvf archive.tar.gz -C /data/restore/</code></pre>
</section>